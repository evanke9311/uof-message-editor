# SQL Insert Composer (Vue 3 + Naive UI)

A tiny, focused web app for quickly composing **`INSERT INTO ... VALUES (...)`** statements and managing reusable field sets. It’s ideal for building and iterating on UOF-style payloads, with a live preview, clipboard copy, auto-incrementing IDs, and local snippet storage.

> ⚠️ This document was automatically generated by a **repo-content-generator** and may contain errors. Please refer to the actual code for accuracy.

---

## Table of Contents

- [Features](#features)
- [Project Requirements](#project-requirements)
- [Dependencies](#dependencies)
- [Getting Started](#getting-started)
- [How to Run](#how-to-run)
- [Usage Guide](#usage-guide)
  - [Compose & Copy](#compose--copy)
  - [Auto-increment ID](#auto-increment-id)
  - [Import from SQL](#import-from-sql)
  - [Save & Load Snippets](#save--load-snippets)

- [Relevant Code Examples](#relevant-code-examples)
  - [`incrementSerial`](#incrementserial)
  - [`parseInsertSQL`](#parseinsertsql)
  - [Local snippet storage](#local-snippet-storage)

- [Architecture Overview](#architecture-overview)
- [Development Tips](#development-tips)
- [Limitations & Notes](#limitations--notes)
- [Roadmap Ideas](#roadmap-ideas)
- [License](#license)

---

## Features

- **Live SQL preview** while you type table name, `id`, and arbitrary key/value pairs.
- **One-click copy** (adds a newline before `VALUES` for readability).
- **Auto-increment `id`** on copy (preserves zero-padding, e.g., `ABC099` → `ABC100`).
- **Import from an existing `INSERT` statement** to prefill the form.
- **Save snippets** (named templates) to **localStorage** and **reload later**.
- **Reorder / insert / delete** form rows when in _Edit form_ mode.
- **Dark theme** via Naive UI and a simple, keyboard-friendly layout.

---

## Project Requirements

- **Node.js**: 18+ recommended (works well with modern Vite/Vue tooling).
- **Package manager**: npm, pnpm, or yarn.
- **Browser**: recent Chromium/Firefox/Safari for `Clipboard API` support.

---

## Dependencies

Runtime libraries used in the app:

- **Vue 3** (Composition API + `<script setup>`)
- **Naive UI** (components, dark theme)
- **@vicons/ionicons5** (icons)
- **@vueuse/core** (reactive localStorage)
- **dayjs** (timestamp formatting in snippet list)

Tooling:

- **Vite** (dev server & build)
- **TypeScript**
- **ESLint + Prettier** (see workspace recommendations under [.vscode](./.vscode))

---

## Getting Started

Install dependencies and launch the dev server.

```bash
# with npm
npm install
npm run dev

# with pnpm
pnpm install
pnpm dev

# with yarn
yarn
yarn dev
```

The app mounts at `#app` (see `src/main.ts`).

---

## How to Run

- **Development**: `npm run dev` (Vite dev server with HMR)
- **Production build**: `npm run build` (outputs to `dist/`)
- **Preview build**: `npm run preview`

> These scripts follow the standard Vite convention. If your package.json differs, adapt accordingly.

---

## Usage Guide

### Compose & Copy

- **Table**: set the table name (default is `afbet_facts.t_facts_sporty_uof_messages`).
- **ID**: fill the `id` value (string or numeric).
- **Fields**: click **create** to add rows; each row has a **key** and a **value**.
- Click **copy** to send the formatted SQL to the clipboard. Success and error toasts are shown.

The generated SQL looks like:

```sql
INSERT INTO afbet_facts.t_facts_sporty_uof_messages (id, key1, key2)
VALUES ('ABC001', 'value1', {"nested": true});
```

### Auto-increment ID

If **Auto update** is checked, the `id` is incremented on every copy.

- Preserves digits and zero-padding at the end of the string.
- Non-numeric suffixes get `000` appended the first time.

Examples:

- `ABC099` → `ABC100`
- `ticket-0009` → `ticket-0010`
- `order` → `order000`

### Import from SQL

Paste an existing `INSERT ... VALUES (...)` statement to prefill the form and `id`.

- The parser supports **quoted strings**, **escaped quotes**, and **JSON-like braces** inside values.
- It validates that the **number of columns matches values**.

```sql
INSERT INTO any.table (id, user_name, payload)
VALUES ('ABC007', "Bruce", {"role":"admin","flags":["A","B"]});
```

After import:

- `id` becomes `ABC007`
- form rows: `user_name = "Bruce"`, `payload = {"role":"admin",...}`

### Save & Load Snippets

- Click **save** to name and store the current template in localStorage.
- Existing snippet names are displayed to prevent collisions.
- Use **Load** from the snippet list card menu to restore a template.
- Use **Delete** to remove it.

> Storage key: `save_template` (see `src/utils/index.ts`).

---

## Relevant Code Examples

### `incrementSerial`

Increments a trailing number in a string while preserving zero padding. If no trailing digits exist, appends `000`.

```ts
incrementSerial('ABC099') // → "ABC100"
incrementSerial('ticket-0009') // → "ticket-0010"
incrementSerial('order') // → "order000"
```

### `parseInsertSQL`

Parses a single-line or multiline `INSERT ... VALUES (...)` string and returns an ordered list of `{ key, value }` pairs. The `id` (if present) is unquoted for convenience.

```ts
const sql = `INSERT INTO t (id, name, payload)
VALUES ('ABC007', 'Clark', {"team":"ops","on":true});`

const kv = parseInsertSQL(sql)
// [
//   { key: 'id', value: 'ABC007' },
//   { key: 'name', value: "'Clark'" },
//   { key: 'payload', value: '{"team":"ops","on":true}' }
// ]
```

**Behavior highlights**

- Tolerates commas inside `{ ... }` and inside quoted strings.
- Throws on **mismatched columns vs values** or missing `VALUES`.

### Local snippet storage

Snippets are stored in localStorage via `@vueuse/core`’s `useStorage` hook under a typed shape.

```ts
export type StorageState = Record<
  string,
  {
    snippet: string
    id: string
    tableName: string
    form: { key: string; value: string }[]
    updateTimestamp: number
  }
>
```

Saving a snippet:

```ts
saveSnippet({ snippet: 'uof-basic', id: 'ABC001', tableName: '...', form: [...] })
```

Deleting:

```ts
deleteSnippet('uof-basic')
```

---

## Architecture Overview

- **`src/App.vue`** — main UI: live preview, form editing (add/move/insert/delete), copy, save, import dialogs.
- **`src/components/SaveDialog.vue`** — name and persist the current template; prevents name collisions.
- **`src/components/ImportDialog.vue`** — accepts raw SQL and feeds parsed values back to the app.
- **`src/components/SnippetList.vue`** — lists saved templates with timestamps; supports load/delete (and placeholder for future edit).
- **`src/utils/index.ts`** — utilities: `incrementSerial`, `parseInsertSQL`, and localStorage helpers.
- **Styling** — global styles in `src/assets`, with Naive UI dark theme in the app shell.

Data flows are deliberately simple: components emit events upward; utilities handle persistence/parse logic to keep UI lean.

---

## Development Tips

- **VS Code**: the repo includes workspace settings and extension recommendations:
  - Volar (Vue), ESLint, EditorConfig, Prettier
  - File nesting rules for Vite/tsconfig/formatter configs

- **Formatting**: Prettier is the default formatter; format-on-save is enabled. ESLint `source.fixAll` on save is set to `explicit`.
- **Templates**: Components use Pug in `<template lang="pug">` for compact markup.

---

## Limitations & Notes

- The SQL generator **does not escape values**; enter values as you want them to appear (quotes, JSON, etc.).
- `parseInsertSQL` is designed for a **single-row** `INSERT`. Multi-row `VALUES` lists are not supported.
- Storage is **local to the browser**. Clearing site data removes saved snippets.
- Clipboard access requires a secure context (HTTPS or localhost).
